-- SQL学习样例

-- 创建数据库
CREATE DATABASE school;

-- 使用数据库
USE school;

-- 1. 建表语句
-- 学生表
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    gender CHAR(1),
    birth_date DATE,
    class VARCHAR(20),
    enrollment_date DATE
);

-- 课程表
CREATE TABLE courses (
    course_id INT PRIMARY KEY,
    course_name VARCHAR(100) NOT NULL,
    credit INT,
    teacher_name VARCHAR(50)
);

-- 选课表
CREATE TABLE student_course (
    id INT PRIMARY KEY AUTO_INCREMENT,
    student_id INT,
    course_id INT,
    select_date DATE,
    score DECIMAL(5,2),
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (course_id) REFERENCES courses(course_id)
);

-- 2. INSERT语句插入数据
-- 插入学生数据
INSERT INTO students (student_id, name, gender, birth_date, class, enrollment_date)
VALUES 
    (1001, '张三', 'M', '2000-03-15', '计算机一班', '2020-09-01'),
    (1002, '李四', 'M', '2001-05-20', '计算机一班', '2020-09-01'),
    (1003, '王五', 'F', '2000-12-10', '计算机二班', '2020-09-01'),
    (1004, '赵六', 'F', '2001-08-25', '计算机二班', '2020-09-01'),
    (1005, '钱七', 'M', '2000-11-30', '数学一班', '2020-09-01'),
    (1006, '周八', 'M', '2001-02-15', '计算机一班', '2020-09-01'),
    (1007, '吴九', 'F', '2000-07-22', '计算机二班', '2020-09-01'),
    (1008, '郑十', 'M', '2001-01-05', '计算机三班', '2020-09-01'),
    (1009, '孙一', 'F', '2000-09-17', '数学一班', '2020-09-01'),
    (1010, '冯二', 'M', '2001-04-29', '数学二班', '2020-09-01'),
    (1011, '陈三', 'F', '2000-08-14', '计算机一班', '2020-09-01'),
    (1012, '楚四', 'M', '2001-11-23', '计算机二班', '2020-09-01'),
    (1013, '魏五', 'F', '2000-06-30', '计算机三班', '2020-09-01'),
    (1014, '蒋六', 'M', '2001-10-12', '数学一班', '2020-09-01'),
    (1015, '沈七', 'F', '2000-12-05', '数学二班', '2020-09-01'),
    (1016, '韩八', 'M', '2001-01-19', '计算机一班', '2020-09-01'),
    (1017, '杨九', 'F', '2000-05-21', '计算机二班', '2020-09-01'),
    (1018, '朱十', 'M', '2001-07-11', '计算机三班', '2020-09-01'),
    (1019, '秦一', 'F', '2000-11-02', '数学一班', '2020-09-01'),
    (1020, '许二', 'M', '2001-03-28', '数学二班', '2020-09-01'),
    (1021, '何三', 'F', '2000-04-15', '计算机一班', '2020-09-01'),
    (1022, '吕四', 'M', '2001-09-20', '计算机二班', '2020-09-01'),
    (1023, '施五', 'F', '2000-10-10', '计算机三班', '2020-09-01'),
    (1024, '张六', 'M', '2001-08-25', '数学一班', '2020-09-01'),
    (1025, '李七', 'F', '2000-02-28', '数学二班', '2020-09-01'),
    (1026, '王八', 'M', '2001-06-15', '计算机一班', '2020-09-01'),
    (1027, '赵九', 'F', '2000-07-22', '计算机二班', '2020-09-01'),
    (1028, '钱十', 'M', '2001-05-05', '计算机三班', '2020-09-01'),
    (1029, '孙一', 'F', '2000-09-17', '数学一班', '2020-09-01'),
    (1030, '周二', 'M', '2001-04-29', '数学二班', '2020-09-01'),
    (1031, '吴三', 'F', '2000-08-14', '计算机一班', '2020-09-01'),
    (1032, '郑四', 'M', '2001-11-23', '计算机二班', '2020-09-01'),
    (1033, '王五', 'F', '2000-06-30', '计算机三班', '2020-09-01'),
    (1034, '冯六', 'M', '2001-10-12', '数学一班', '2020-09-01'),
    (1035, '陈七', 'F', '2000-12-05', '数学二班', '2020-09-01'),
    (1036, '褚八', 'M', '2001-01-19', '计算机一班', '2020-09-01'),
    (1037, '卫九', 'F', '2000-05-21', '计算机二班', '2020-09-01'),
    (1038, '蒋十', 'M', '2001-07-11', '计算机三班', '2020-09-01'),
    (1039, '沈一', 'F', '2000-11-02', '数学一班', '2020-09-01'),
    (1040, '韩二', 'M', '2001-03-28', '数学二班', '2020-09-01'),
    (1041, '杨三', 'F', '2000-04-15', '计算机一班', '2020-09-01'),
    (1042, '朱四', 'M', '2001-09-20', '计算机二班', '2020-09-01'),
    (1043, '秦五', 'F', '2000-10-10', '计算机三班', '2020-09-01'),
    (1044, '许六', 'M', '2001-08-25', '数学一班', '2020-09-01'),
    (1045, '何七', 'F', '2000-02-28', '数学二班', '2020-09-01'),
    (1046, '吕八', 'M', '2001-06-15', '计算机一班', '2020-09-01'),
    (1047, '施九', 'F', '2000-07-22', '计算机二班', '2020-09-01'),
    (1048, '张十', 'M', '2001-05-05', '计算机三班', '2020-09-01'),
    (1049, '李一', 'F', '2000-09-17', '数学一班', '2020-09-01'),
    (1050, '王二', 'M', '2001-04-29', '数学二班', '2020-09-01'),
    (1051, '赵三', 'F', '2002-08-14', '计算机一班', '2020-09-01'),
    (1052, '钱四', 'M', '2002-11-23', '计算机二班', '2020-09-01'),
    (1053, '孙五', 'F', '2002-06-30', '计算机三班', '2020-09-01'),
    (1054, '周六', 'M', '2002-10-12', '数学一班', '2020-09-01'),
    (1055, '吴七', 'F', '2002-12-05', '数学二班', '2020-09-01'),
    (1056, '郑八', 'M', '2002-01-19', '计算机一班', '2020-09-01'),
    (1057, '王九', 'F', '2002-05-21', '计算机二班', '2020-09-01'),
    (1058, '冯十', 'M', '2002-07-11', '计算机三班', '2020-09-01'),
    (1059, '陈一', 'F', '2002-11-02', '数学一班', '2020-09-01'),
    (1060, '褚二', 'M', '2002-03-28', '数学二班', '2020-09-01'),
    (1061, '卫三', 'F', '2002-04-15', '计算机一班', '2020-09-01'),
    (1062, '蒋四', 'M', '2002-09-20', '计算机二班', '2020-09-01'),
    (1063, '沈五', 'F', '2002-10-10', '计算机三班', '2020-09-01'),
    (1064, '韩六', 'M', '2002-08-25', '数学一班', '2020-09-01'),
    (1065, '杨七', 'F', '2002-02-28', '数学二班', '2020-09-01'),
    (1066, '朱八', 'M', '2002-06-15', '计算机一班', '2020-09-01'),
    (1067, '秦九', 'F', '2002-07-22', '计算机二班', '2020-09-01'),
    (1068, '许十', 'M', '2002-05-05', '计算机三班', '2020-09-01'),
    (1069, '何一', 'F', '2002-09-17', '数学一班', '2020-09-01'),
    (1070, '吕二', 'M', '2002-04-29', '数学二班', '2020-09-01'),
    (1071, '施三', 'F', '2003-08-14', '计算机一班', '2020-09-01'),
    (1072, '张四', 'M', '2003-11-23', '计算机二班', '2020-09-01'),
    (1073, '李五', 'F', '2003-06-30', '计算机三班', '2020-09-01'),
    (1074, '王六', 'M', '2003-10-12', '数学一班', '2020-09-01'),
    (1075, '赵七', 'F', '2003-12-05', '数学二班', '2020-09-01'),
    (1076, '钱八', 'M', '2003-01-19', '计算机一班', '2020-09-01'),
    (1077, '孙九', 'F', '2003-05-21', '计算机二班', '2020-09-01'),
    (1078, '周十', 'M', '2003-07-11', '计算机三班', '2020-09-01'),
    (1079, '吴一', 'F', '2003-11-02', '数学一班', '2020-09-01'),
    (1080, '郑二', 'M', '2003-03-28', '数学二班', '2020-09-01'),
    (1081, '王三', 'F', '2003-04-15', '计算机一班', '2020-09-01'),
    (1082, '冯四', 'M', '2003-09-20', '计算机二班', '2020-09-01'),
    (1083, '陈五', 'F', '2003-10-10', '计算机三班', '2020-09-01'),
    (1084, '褚六', 'M', '2003-08-25', '数学一班', '2020-09-01'),
    (1085, '卫七', 'F', '2003-02-28', '数学二班', '2020-09-01'),
    (1086, '蒋八', 'M', '2003-06-15', '计算机一班', '2020-09-01'),
    (1087, '沈九', 'F', '2003-07-22', '计算机二班', '2020-09-01'),
    (1088, '韩十', 'M', '2003-05-05', '计算机三班', '2020-09-01'),
    (1089, '杨一', 'F', '2003-09-17', '数学一班', '2020-09-01'),
    (1090, '朱二', 'M', '2003-04-29', '数学二班', '2020-09-01'),
    (1091, '秦三', 'F', '2002-08-14', '计算机一班', '2020-09-01'),
    (1092, '许四', 'M', '2002-11-23', '计算机二班', '2020-09-01'),
    (1093, '何五', 'F', '2002-06-30', '计算机三班', '2020-09-01'),
    (1094, '吕六', 'M', '2002-10-12', '数学一班', '2020-09-01'),
    (1095, '施七', 'F', '2002-12-05', '数学二班', '2020-09-01'),
    (1096, '张八', 'M', '2001-01-19', '计算机一班', '2020-09-01'),
    (1097, '李九', 'F', '2001-05-21', '计算机二班', '2020-09-01'),
    (1098, '王十', 'M', '2001-07-11', '计算机三班', '2020-09-01'),
    (1099, '赵一', 'F', '2001-11-02', '数学一班', '2020-09-01'),
    (1100, '钱二', 'M', '2001-03-28', '数学二班', '2020-09-01');

-- 插入课程数据
INSERT INTO courses (course_id, course_name, credit, teacher_name)
VALUES
    (101, '数据库原理', 4, '陈教授'),
    (102, '操作系统', 4, '李教授'),
    (103, '数据结构', 3, '王教授'),
    (104, '计算机网络', 3, '张教授'),
    (105, '高等数学', 5, '刘教授');

-- 插入选课数据
INSERT INTO student_course (student_id, course_id, select_date, score)
VALUES
    (1001, 101, '2020-09-10', 85.5),
    (1001, 102, '2020-09-10', 92.0),
    (1002, 101, '2020-09-11', 78.5),
    (1002, 103, '2020-09-11', 88.0),
    (1003, 102, '2020-09-12', 95.5),
    (1003, 104, '2020-09-12', 87.0),
    (1004, 103, '2020-09-13', 82.5),
    (1004, 105, '2020-09-13', 79.0),
    (1005, 104, '2020-09-14', 91.0),
    (1005, 105, '2020-09-14', 93.5);

-- 3. SELECT语句查询数据
-- 基本查询
SELECT * FROM students;
SELECT * FROM courses;
SELECT * FROM student_course;

-- 条件查询
SELECT * FROM students WHERE gender = 'F';
SELECT * FROM courses WHERE credit >= 4;

-- 排序查询
SELECT * FROM students ORDER BY birth_date DESC;
SELECT * FROM student_course ORDER BY score DESC;

-- 聚合函数
SELECT AVG(score) AS average_score FROM student_course;
SELECT course_id, AVG(score) AS average_score FROM student_course GROUP BY course_id;
SELECT COUNT(*) AS student_count FROM students;

-- 多表联合查询
SELECT s.name, c.course_name, sc.score
FROM students s
JOIN student_course sc ON s.student_id = sc.student_id
JOIN courses c ON sc.course_id = c.course_id;

-- 子查询
SELECT name FROM students 
WHERE student_id IN (SELECT student_id FROM student_course WHERE score > 90);

-- 4. DELETE语句删除数据
-- 删除选课记录
DELETE FROM student_course WHERE student_id = 1005 AND course_id = 105;

-- 删除课程（注意：如果有关联的选课记录，需要先删除关联记录）
DELETE FROM courses WHERE course_id = 105;

-- 删除学生（注意：如果有关联的选课记录，需要先删除关联记录）
DELETE FROM students WHERE student_id = 1005;

-- 5. UPDATE语句更新数据
-- 更新学生信息
UPDATE students SET class = '计算机三班' WHERE student_id = 1001;

-- 更新课程信息
UPDATE courses SET credit = 5 WHERE course_id = 103;

-- 更新成绩
UPDATE student_course SET score = 88.5 WHERE student_id = 1001 AND course_id = 101;
